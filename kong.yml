_format_version: "3.0"

services:
  - name: training-service
    url: http://host.docker.internal:8080
    routes:
      - name: training-api
        paths: ["/training", "/training/*"]
        methods: ["GET", "POST", "PUT", "DELETE", "PATCH"]
        strip_path: true
        preserve_host: false

      - name: training-swagger
        paths: ["/training/swagger", "/training/swagger/*"]
        strip_path: true

  - name: user-info-service
    url: http://host.docker.internal:8081
    routes:
      - name: user-info-api
        paths: ["/user-info", "/user-info/*"]
        methods: ["GET", "POST", "PUT", "DELETE", "PATCH"]
        strip_path: false
        preserve_host: false

      - name: user-info-swagger
        paths: ["/user-info/swagger", "/user-info/swagger/*"]
        strip_path: true

plugins:
  - name: cors
    config:
      origins: ["*"]
      methods: ["GET", "POST", "PUT", "DELETE", "OPTIONS"]
      headers: ["Accept", "Authorization", "Content-Type"]
      exposed_headers: []
      credentials: false
      max_age: 3600
      
  - name: rate-limiting
    config:
      minute: 60
      policy: local
      limit_by: consumer
      hide_client_headers: false